#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
扩充章节脚本 - 将76-80章扩充到每章3000字左右
"""

import re

def count_chinese_chars(text):
    """统计中文字符数量"""
    chinese_pattern = re.compile(r'[\u4e00-\u9fff]')
    return len(chinese_pattern.findall(text))

def expand_chapter_76(content):
    """扩充第76章"""
    
    # 替换1：扩充考生入场描写
    content = content.replace(
        "考生们提着考篮鱼贯而入，脸上的表情既紧张又期待，偶尔有人因为被搜出违禁品而当场被拖走，引来周围一片惊呼。\n\n萧千卷分到了"天地玄黄"中的"黄字九号"号舍。",
        """考生们提着考篮鱼贯而入，脸上的表情既紧张又期待，偶尔有人因为被搜出违禁品而当场被拖走，引来周围一片惊呼。

萧千卷跟随着人流缓缓前行，他的目光平静地观察着周围的一切。前面一个穿着华丽锦袍的公子哥在经过灵镜检测时，储物戒指中竟然藏着一本抄满了经义注解的小册子，当场被没收，那公子哥脸色煞白，几乎站不稳脚。旁边一个衣衫简陋的寒门学子则紧张得浑身发抖，在检查时不小心打翻了考篮，里面滚出几个干瘪的馒头和一瓶浑浊的井水——那就是他三天考试的全部口粮。

"下一个！快点！"监考官不耐烦的声音响起。

萧千卷深吸一口气，踏入了第一道关卡。冰冷的金属探测符文扫过他的身体，带来一阵刺痛感。紧接着是灵镜检测，那面古朴的铜镜表面泛起一层水波般的涟漪，将他从头到脚扫描了一遍。最后是照心阁，当他走过那座小楼下方时，梁柱上的诚信符文微微闪烁了一下，但没有发出警报。

"过！"

萧千卷分到了"天地玄黄"中的"黄字九号"号舍。"""
    )
    
    # 替换2：扩充号舍描写
    content = content.replace(
        "这是一个只有三尺宽的狭小隔间，吃饭、睡觉、答题都要在这个鸽子笼里解决。对于那些养尊处优的世家子弟来说，光是这个环境就足以让他们崩溃。\n\n但萧千卷很淡定。他整理好笔墨纸砚，拿出铁柱特制的"自热火锅"（机关版），甚至还有闲心观察周围的考生。",
        """这是一个只有三尺宽的狭小隔间，吃饭、睡觉、答题都要在这个鸽子笼里解决。对于那些养尊处优的世家子弟来说，光是这个环境就足以让他们崩溃。

号舍内的墙壁是用青砖砌成的，墙面上还残留着前一届考生刻下的字迹："天道酬勤"、"金榜题名"、"苦尽甘来"。地面是冰冷潮湿的石板，散发着一股霉味。一张窄小的木板床，一张简陋的书案，一盏微弱的油灯——这就是号舍的全部陈设。透过木板墙的缝隙，能听到隔壁考生压抑的喘息声和翻动纸张的沙沙声。

但萧千卷很淡定。他整理好笔墨纸砚，将毛笔一支支摆放整齐，砚台中注入清水，轻轻研磨起墨来。墨香渐渐弥漫开来，那种熟悉的味道让他的心神逐渐沉静下来。他拿出铁柱特制的"自热火锅"（机关版），那是一个巧妙的机关装置，底部有符文加热阵，不需要明火就能煮熟食物。他甚至还有闲心观察周围的考生。"""
    )
    
    # 替换3：扩充考题发布
    content = content.replace(
        "左边那个正在发抖，牙齿打颤的声音隔着墙板都能听见；右边那个刚进来就开始磨墨，一边磨一边哭，估计是想起了家中老母的期望。\n\n"铛——"\n\n考题发布。\n\n两名差役举着巨大的题板在走道里巡回展示。\n\n题目只有五个字：**《论天道不变》**。\n\n号舍里响起了一片吸气声，紧接着是无数笔尖落在纸上的沙沙声。这题目太经典了，简直是送分题。",
        """左边那个正在发抖，牙齿打颤的声音隔着墙板都能听见，还夹杂着细碎的呜咽声，像是在念叨着什么；右边那个刚进来就开始磨墨，一边磨一边哭，砚台里的水都快被泪水稀释了，估计是想起了家中老母的期望，或是想到了举家借债供他读书的辛酸。

远处传来钟声，一声接着一声，每一声都像是敲在考生们的心上。贡院内开始弥漫起一股凝重的气息，那是数千名考生的紧张情绪交织在一起形成的压抑氛围。有人在默默祈祷，有人在深呼吸调整心态，还有人已经开始在心中演练起答题的策略。

"铛——"

考题发布。

两名差役举着巨大的题板在走道里巡回展示。那题板足有一人高，上面用朱砂写着醒目的大字，在晨光中泛着血红色的光芒。差役们的脚步声沉重而缓慢，每走一步都发出"咚咚"的响声，像是战场上的战鼓。

题目只有五个字：**《论天道不变》**。

号舍里响起了一片吸气声，紧接着是无数笔尖落在纸上的沙沙声。这题目太经典了，简直是送分题。一些考生脸上露出了如释重负的表情，手中的笔立刻舞动起来，墨汁在纸上铺展开来，形成一行行工整的文字。空气中弥漫着墨香和纸张摩擦的味道，还有考生们因为松了一口气而轻轻呼出的气息。"""
    )
    
    # 替换4：扩充主考楼描写
    content = content.replace(
        "主考楼上。\n\n大儒欧阳修文抚摸着胡须，看着下方埋头苦写的考生们，满意地点了点头。\n\n"今科的题目虽然保守，但最能考校学子的基本功和忠心。"他对着身边的副考官说，"只要不出乱子，便是大幸。"\n\n然而，他话音未落，一股异样的气息突然从黄字区升起。",
        """主考楼上。

大儒欧阳修文抚摸着胡须，看着下方埋头苦写的考生们，满意地点了点头。他端起茶盏，轻轻吹去浮在表面的茶叶，啜饮一口，温热的茶水顺着喉咙滑下，让他的心情更加舒畅。

主考楼是贡院内最高的建筑，从这里可以俯瞰整个考场。楼内陈设雅致，墙上挂着历代状元的画像，书架上摆满了经典典籍，檀木桌案上摆放着精美的文房四宝。窗外的梧桐树叶在微风中沙沙作响，阳光透过窗棂洒进来，在地板上投下斑驳的光影。

"今科的题目虽然保守，但最能考校学子的基本功和忠心。"他对着身边的副考官说，语气中带着几分得意，"老夫精心选择这道题，就是要看看这些学子是否真正理解了圣人之道，是否真正明白君臣父子之纲常。只要不出乱子，便是大幸。"

副考官点头附和："欧阳大人英明。这道题出得好，既能筛选出真才实学之士，又能确保不会出现那些离经叛道的异端邪说。"

然而，他话音未落，一股异样的气息突然从黄字区升起。那气息带着一股强烈的冲击力，像是一道闪电划破了宁静的天空，让整个主考楼都微微震动起来。"""
    )
    
    # 替换5：扩充萧千卷思考过程
    content = content.replace(
        "号舍内。\n\n萧千卷看着那五个字，嘴角勾起一抹嘲讽的弧度。\n\n天不变？道亦不变？\n\n这种僵化的思想，正是人族如今被妖族压制、只能龟缩在城墙内的根源！\n\n"如果天道真的不变，那人族还在茹毛饮血，还在山洞里瑟瑟发抖，膜拜雷电。"\n\n他提起笔，饱蘸浓墨。",
        """号舍内。

萧千卷看着那五个字，嘴角勾起一抹嘲讽的弧度。

天不变？道亦不变？

这种僵化的思想，正是人族如今被妖族压制、只能龟缩在城墙内的根源！

他闭上眼睛，脑海中浮现出前世在地球上读到的那些改变人类文明进程的理论：达尔文的《物种起源》，严复翻译的《天演论》，那些关于进化、适应、竞争的思想。那些思想在当时的中国引起了多么大的震撼，打破了多少人对"天命不可违"的迷信，唤醒了多少人的革新意识。

"如果天道真的不变，那人族还在茹毛饮血，还在山洞里瑟瑟发抖，膜拜雷电。"他低声自语，声音中带着一股坚定的信念，"如果道真的不可改变，那就不会有文字的发明，不会有青铜的铸造，不会有铁器的普及，更不会有如今的文明。正是因为不断进化，不断改变，人族才能从最弱小的生物一步步走到今天。"

他睁开眼睛，眼神变得锐利如刀。他提起笔，饱蘸浓墨。笔尖在砚台边缘轻轻一顿，墨汁顺着笔尖凝聚成一滴晶莹的墨珠，在阳光下闪烁着幽暗的光芒。"""
    )
    
    # 继续扩充...
    content = content.replace(
        "在这个强调"法古"、"复礼"的世界，他决定扔下一颗来自另一个文明的深水炸弹。\n\n题目：**《天演论：论生物与文明的演化博弈》**。\n\n"赫胥黎独处一室之中，在英伦之南，背山而面野……曰：物竞天择，适者生存。"\n\n起笔便是严复先生那句振聋发聩的翻译名句，但他并未止步于此，而是融入了达尔文《物种起源》的核心逻辑和社会达尔文主义的批判性思考。\n\n萧千卷运笔如飞，文气随着墨迹在纸上炸开，每一个字都像是一个活跃的细胞，在纸面上分裂、增殖。",
        """在这个强调"法古"、"复礼"的世界，他决定扔下一颗来自另一个文明的深水炸弹。

他的手在空中微微颤抖了一下，不是因为恐惧，而是因为兴奋。他知道，自己接下来要写的东西，将会颠覆这个世界千年来的认知，将会撼动那些自以为掌握真理的权威。但他不在乎，因为真理从来不会因为违背传统就失去其价值。

题目：**《天演论：论生物与文明的演化博弈》**。

当他在纸上写下这个题目时，周围的空气仿佛都凝固了一瞬间。这个题目与考题要求的《论天道不变》完全相反，简直就是在公然挑战出题者的意图。

"赫胥黎独处一室之中，在英伦之南，背山而面野……曰：物竞天择，适者生存。"

起笔便是严复先生那句振聋发聩的翻译名句，但他并未止步于此，而是融入了达尔文《物种起源》的核心逻辑和社会达尔文主义的批判性思考。字字珠玑，句句锋利，像是一把把利剑，直指那些腐朽僵化的教条。

萧千卷运笔如飞，文气随着墨迹在纸上炸开，每一个字都像是一个活跃的细胞，在纸面上分裂、增殖。他的笔触时而刚劲有力，如同铁划银钩，时而流畅飘逸，如同行云流水。墨香在号舍内弥漫开来，那不是普通的墨香，而是带着一股强烈的精神冲击力的文气之香。"""
    )
    
    # 扩充论述部分
    content = content.replace(
        "他没有写那些酸腐的排比句，这直接阐述了一个残酷而真实的真理：\n\n这个世界从来没有什么永恒不变的秩序，只有不断变化的"环境参数"和为了适应参数而不断迭代的"生命算法"。\n\n万物都在竞争，都在进化。优胜劣汰，弱肉强食。这才是天道！\n\n"世道必进，后胜于今！固步自封者，必将被历史的垃圾堆掩埋！"",
        """他没有写那些酸腐的排比句，没有引用那些被无数考生重复了千百遍的经典，而是直接阐述了一个残酷而真实的真理：

这个世界从来没有什么永恒不变的秩序，只有不断变化的"环境参数"和为了适应参数而不断迭代的"生命算法"。

他在文中详细论述了物种的演化过程，从最原始的单细胞生物到复杂的多细胞生物，从水中的鱼类到陆地的走兽，从爬行的蜥蜴到飞翔的鸟类。每一次进化都是对环境的适应，每一次突破都是对旧秩序的颠覆。那些无法适应环境变化的物种，无论曾经多么强大，都只能走向灭绝。

万物都在竞争，都在进化。优胜劣汰，弱肉强食。这才是天道！

他的笔锋越来越犀利，文字越来越激昂。纸张上的墨迹仿佛活了过来，在纸面上流动、跳跃，形成一幅幅生动的画面。有远古巨兽的咆哮，有弱小生物的挣扎，有物种兴衰的轮回，有文明演进的史诗。

"世道必进，后胜于今！固步自封者，必将被历史的垃圾堆掩埋！""""
    )
    
    # 扩充异象描写
    content = content.replace(
        "当他写到这一句时，整张试卷突然燃烧起来——不是真的火，而是金色的文气之火，火光中隐约可见DNA双螺旋结构的虚影在旋转。\n\n"轰！"\n\n一道金色的光柱直接冲破了号舍的屋顶，直插云霄。\n\n正在巡考的监考官吓得一屁股坐在地上："炸……炸号了？这是什么异象？怎么看着像是一群虫子在打架？"\n\n紧接着，所有人惊恐地看到，那金光并没有消散，而是在天空中演化出了奇异的景象。",
        """当他写到这一句时，整张试卷突然燃烧起来——不是真的火，而是金色的文气之火，火光中隐约可见DNA双螺旋结构的虚影在旋转。那虚影散发着神秘的光芒，仿佛蕴含着生命演化的终极密码。

"轰！"

一道金色的光柱直接冲破了号舍的屋顶，直插云霄。木板和瓦片在文气的冲击下化作齑粉，纷纷扬扬地飘落下来。那光柱粗如水桶，金光璀璨，照亮了整个贡院，甚至让白日的阳光都黯然失色。

正在巡考的监考官吓得一屁股坐在地上，手中的巡考牌掉在地上发出"啪"的一声脆响。他瞪大眼睛，张大嘴巴，半晌说不出话来。好不容易回过神来，声音都变了调："炸……炸号了？这是什么异象？怎么看着像是一群虫子在打架？"

其他的监考官也纷纷停下脚步，抬头望向天空，脸上写满了震惊和不解。有人下意识地摸向腰间的法器，准备应对可能出现的危险。有人则连忙掏出记录符文，想要记录下这前所未见的异象。

紧接着，所有人惊恐地看到，那金光并没有消散，而是在天空中演化出了奇异的景象。空气中弥漫着一股强烈的文气波动，让人感到一阵眩晕。"""
    )
    
    # 扩充进化史画面
    content = content.replace(
        "先是一片汪洋大海，无数微小的单细胞生物在其中沉浮。接着，光点变成了鱼，鱼长出了腿爬上陆地，变成了兽。兽群互相厮杀，弱小的被吞噬，强大的生存下来，慢慢直立行走，学会了使用火，学会了制造工具……\n\n那是一部浓缩的生命进化史！是一部如果不进步就会死的恐怖纪录片！\n\n那种为了生存而挣扎、而奋斗、而进化的原始生命力，如同洪流一般冲击着每一个看到这一幕的人的心灵。尤其是那些一直被教导"安贫乐道"的寒门学子，只觉得体内有什么东西被点燃了。",
        """先是一片汪洋大海，波涛汹涌，浪花翻滚。海水呈现出深蓝色，在阳光的照射下泛着粼粼波光。无数微小的单细胞生物在其中沉浮，它们渺小如尘埃，却顽强地生存着，不断分裂、繁殖、演化。

接着，光点变成了鱼，成群结队地在海中游弋。它们的鳞片在阳光下闪烁着银色的光芒，尾鳍有力地摆动着，在水中划出一道道优美的弧线。然后，鱼长出了腿，那是一个艰难而漫长的过程，从鳍到肢，从水生到两栖，每一步都充满了挣扎和痛苦。它们爬上陆地，在泥泞中蹒跚前行，变成了兽。

兽群互相厮杀，弱小的被吞噬，强大的生存下来。那是一幅幅血腥而残酷的画面：巨兽撕咬着猎物的血肉，弱小的生物在利爪下哀嚎，失败者的尸骨散落一地，胜利者仰天长啸。在无数次的生死搏杀中，它们慢慢直立行走，前肢变成了可以抓握工具的手，大脑变得越来越发达。它们学会了使用火，火光在黑暗中跳跃，驱散了寒冷和野兽。它们学会了制造工具，用石头打磨成锋利的武器，用兽皮缝制成保暖的衣物……

那是一部浓缩的生命进化史！是一部如果不进步就会死的恐怖纪录片！

画面中的每一个细节都如此真实，如此震撼。可以看到生物在环境变化中的挣扎，可以看到物种在竞争中的淘汰，可以看到生命在绝境中爆发出的惊人潜力。那种为了生存而挣扎、而奋斗、而进化的原始生命力，如同洪流一般冲击着每一个看到这一幕的人的心灵。

尤其是那些一直被教导"安贫乐道"、"认命守分"的寒门学子，看到这一幕，只觉得体内有什么东西被点燃了。那是一种久违的渴望，是一种对改变命运的渴望，是一种不甘于现状的反抗精神。他们的眼睛变得明亮起来，拳头不自觉地握紧，心跳加快，血液沸腾。"""
    )
    
    # 扩充欧阳修文的反应
    content = content.replace(
        ""这……这是什么邪说？！"\n\n欧阳修文猛地站起来，手中的茶杯摔得粉碎。他看到画面中，那些代表"旧秩序"的庞然大物（恐龙）因为无法适应环境而灭绝，而弱小的哺乳动物却最终统治了世界。\n\n这哪里是论天道，这分明是在诅咒大周皇朝如果不改革就会像那些巨大的蜥蜴一样灭亡！这简直是在给"造反"提供理论依据！\n\n"大逆不道！大逆不道！"欧阳修文气得浑身发抖，胡子都翘起来了，"快！去看看是谁写的！给我封了他的卷子！这上面的图画太恶心了，有辱斯文！"\n\n几个锦衣卫立刻向黄字九号冲去。",
        """"这……这是什么邪说？！"

欧阳修文猛地站起来，动作太过剧烈，椅子都被掀翻在地。手中的茶杯摔得粉碎，茶水溅了一地，染湿了他的袍角。他的脸色涨红，青筋暴起，一双眼睛死死盯着天空中的异象，眼珠子都快瞪出来了。

他看到画面中，那些代表"旧秩序"的庞然大物（恐龙）因为无法适应环境而灭绝，它们庞大的身躯轰然倒下，掀起漫天尘土，曾经不可一世的霸主就这样消失在历史的长河中。而弱小的哺乳动物却最终统治了世界，它们机警、灵活、适应力强，在恶劣的环境中顽强生存下来，最终成为新时代的主宰。

这哪里是论天道，这分明是在诅咒大周皇朝如果不改革就会像那些巨大的蜥蜴一样灭亡！这简直是在给"造反"提供理论依据！在暗示那些寒门学子，只要不断进化、不断革新，就能推翻那些看似强大实则腐朽的旧势力！

欧阳修文的手剧烈地颤抖着，指甲都快掐进肉里。他的喉咙里发出一阵阵低吼，像是受伤的野兽。周围的官员都被他的反应吓到了，纷纷后退几步，面面相觑，不知道该如何是好。

"大逆不道！大逆不道！"欧阳修文气得浑身发抖，胡子都翘起来了，脸上的肌肉因为愤怒而扭曲变形，"快！去看看是谁写的！给我封了他的卷子！不，给我烧了他的卷子！这上面的图画太恶心了，有辱斯文！这是在败坏纲常，动摇国本！"

几个锦衣卫立刻向黄字九号冲去，脚步声在走廊中回响，急促而沉重。他们手按刀柄，面色严峻，像是要去抓捕什么穷凶极恶的罪犯。"""
    )
    
    # 扩充考生反应
    content = content.replace(
        "但还没等他们靠近，所有的考生都停下了笔。\n\n他们呆呆地看着天空中的异象，看着那句在云端浮现的巨大金字：\n\n**物竞天择，适者生存。**\n\n一股从未有过的热血在这些寒门学子心中沸腾。\n\n原来，出身并不是注定的？\n\n原来，弱小并不是罪过？\n\n只要努力进化，只要适应环境，只要不断升级自己的"算法"，泥鳅也能变成真龙？\n\n"好句！好句啊！"\n\n不知道是谁喊了一声。紧接着，整个贡院爆发出了一阵压抑不住的喝彩声。\n\n那些锦衣卫被这股沸腾的民意（考生意）震慑住了，竟然一时不敢上前。",
        """但还没等他们靠近，所有的考生都停下了笔。

笔尖悬在纸上，墨汁滴落下来，在纸面上晕开一片墨花。但他们毫不在意，全都呆呆地看着天空中的异象，眼神中充满了震撼、迷茫、激动等复杂的情绪。

看着那句在云端浮现的巨大金字：

**物竞天择，适者生存。**

八个大字，每一个都有房屋那么大，金光灿烂，悬浮在空中，散发着一股震撼人心的力量。那不仅仅是文字，更像是天地法则的显化，带着一种无可辩驳的真理之感。

一股从未有过的热血在这些寒门学子心中沸腾。

他们感到胸口发热，心跳加速，仿佛有一团火焰在胸腔中燃烧。那些被压抑了多年的不甘、愤怒、渴望，在这一刻全都爆发出来。

原来，出身并不是注定的？

原来，弱小并不是罪过？

那些世家子弟之所以能够高高在上，不是因为他们天生就比我们优越，只是因为他们的祖先在过去的竞争中胜出了。但这并不意味着我们永远都要低人一等，只要我们也努力进化，也不断适应环境，也不断升级自己，就有机会超越他们！

只要努力进化，只要适应环境，只要不断升级自己的"算法"，泥鳅也能变成真龙？

这个想法在他们心中生根发芽，疯狂生长，像是打开了一扇新世界的大门。

"好句！好句啊！"

不知道是谁喊了一声，声音激动而颤抖。紧接着，整个贡院爆发出了一阵压抑不住的喝彩声。那些寒门学子们纷纷站起来，挥舞着拳头，大声呼喊，眼眶都红了。他们的声音汇聚在一起，形成一股巨大的声浪，震得贡院的墙壁都在颤抖。

那些锦衣卫被这股沸腾的民意（考生意）震慑住了，竟然一时不敢上前。他们面面相觑，握着刀柄的手都在微微颤抖。这么多考生，这么激动的情绪，如果强行动手，恐怕会引发暴乱。"""
    )
    
    # 扩充结尾
    content = content.replace(
        "号舍里。\n\n萧千卷放下笔，看着试卷上那几个力透纸背的大字，轻轻吹干了墨迹。\n\n"封我的卷子？"\n\n他抬头看了一眼主考楼的方向，眼神平静如水，仿佛是一个那个站在巨兽尸体上的原始人猎手。\n\n"这篇文章一旦现世，就已经印在了人心上。就像病毒一样，一旦传播开来，就没有防火墙能挡得住。"\n\n（第七十六章 完）",
        """号舍里。

萧千卷放下笔，看着试卷上那几个力透纸背的大字，轻轻吹干了墨迹。纸张上的墨迹已经完全干透，散发着淡淡的墨香。那些文字仿佛活了过来，在纸面上流动、跳跃，带着一股强大的生命力。

他听到外面的喝彩声，嘴角勾起一抹微笑。这笑容中既有满意，也有一丝嘲讽，还有一种掌控全局的自信。

"封我的卷子？"

他抬头看了一眼主考楼的方向，眼神平静如水，仿佛是那个站在巨兽尸体上的原始人猎手，眼中既有胜利的喜悦，也有对未知挑战的期待。他知道，欧阳修文此刻一定气得跳脚，那些保守派官员一定恨不得把他千刀万剐。

但他不在乎。

"这篇文章一旦现世，就已经印在了人心上。就像病毒一样，一旦传播开来，就没有防火墙能挡得住。"他低声自语，声音中带着一股坚定的信念，"思想的力量，远比刀剑更强大。它可以被压制一时，但不可能被消灭。只要有人记得这些话，只要有人相信这些理念，它就会不断传播，不断发酵，最终改变这个世界。"

他站起身，整理了一下衣衫，目光望向远方。透过号舍的小窗，可以看到贡院外的天空，那片天空湛蓝辽阔，仿佛蕴含着无限的可能。

他知道，这只是开始。

真正的战斗，还在后面。

（第七十六章 完）"""
    )
    
    return content

# 主程序
if __name__ == "__main__":
    # 读取第76章
    with open("/home/runner/work/WenDao-Legend/WenDao-Legend/drafts/volume_01/ch076_exam_theory_evolution.md", "r", encoding="utf-8") as f:
        ch76 = f.read()
    
    # 扩充
    ch76_expanded = expand_chapter_76(ch76)
    
    # 写回文件
    with open("/home/runner/work/WenDao-Legend/WenDao-Legend/drafts/volume_01/ch076_exam_theory_evolution.md", "w", encoding="utf-8") as f:
        f.write(ch76_expanded)
    
    # 统计字数
    char_count = count_chinese_chars(ch76_expanded)
    print(f"第76章扩充完成，当前中文字符数：{char_count}")
