#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Script to refine chapters 156-160 by adding descriptive content
while preserving original plot and dialogues.
"""

import re

def refine_ch156(content):
    """Add environmental and psychological descriptions to chapter 156"""
    
    # Already partially refined, continue with remaining sections
    replacements = [
        # Line 17-22: Add psychological description for Xiao Qianjuan
        (
            r'"看来影门那些家伙急了。"\n\n萧千卷坐在韩国的王座上，目光紧紧盯着西方的秦国版图。\n\n自从在那场"新郑保卫战"中吃了大亏后',
            '"看来影门那些家伙急了。"\n\n萧千卷坐在韩国的王座上，目光紧紧盯着西方的秦国版图。这张由紫檀木雕刻而成的王座散发着淡淡的清香，但此刻他却丝毫没有心思享受。他的双手轻轻握着扶手，指尖微微发白——那是内心紧张的表现，虽然他的脸上依然保持着从容的表情。\n\n自从在那场"新郑保卫战"中吃了大亏后'
        ),
        # Add emotion to dialogue exchanges
        (
            r'韩知白的声音在公共频道里响起。此刻的他正控制着赵国',
            '韩知白的声音在公共频道里响起，依然是那种不带任何情绪波动的冷静语调。此刻的他正控制着赵国'
        ),
        (
            r'"那你还不动手？"墨染在频道里喊道，"唇亡齿寒懂不懂',
            '"那你还不动手？"墨染在频道里喊道，声音里满是焦急。萧千卷仿佛能看到她此刻咬牙切齿的样子，"唇亡齿寒懂不懂'
        ),
        (
            r'"真是个死脑筋。"墨染骂了一句，转头看向萧千卷',
            '"真是个死脑筋。"墨染骂了一句，声音里满是无奈。她转头看向萧千卷，那双明亮的眼睛里闪烁着期待和信任'
        ),
        (
            r'萧千卷看着手中的财报，嘴角露出一丝高深莫测的笑容。',
            '萧千卷能感受到她话语中的担忧，但更多的是对他的信任。这份信任让他心中涌起一股暖流，同时也让他肩上的责任更加沉重。他看着手中的财报，一行行数据在眼前跳动，嘴角慢慢露出一丝高深莫测的笑容。'
        ),
        (
            r'他站起身，在系统面板上输入了新的指令。',
            '他缓缓站起身来，王座上的绸缎随着他的动作发出轻微的窸窣声。他走到系统面板前，修长的手指在光幕上灵活地跳动，一个个指令被精准地输入进去。'
        ),
        (
            r'"墨染，你的\'幻音坊\'既然不能造高达，那就造点别的。比如……能自动播放影像的\'留影石\'？"\n\n"你要干嘛？"',
            '"墨染，你的\'幻音坊\'既然不能造高达，那就造点别的。比如……能自动播放影像的\'留影石\'？"萧千卷回过头，眼神中闪烁着狡黠的光芒。\n\n"你要干嘛？"墨染的声音里满是困惑，但同时又隐隐带着一丝兴奋。她最喜欢萧千卷这种出人意料的想法。'
        ),
        (
            r'"拍电影。"萧千卷语出惊人，"不用太深奥',
            '"拍电影。"萧千卷语出惊人，嘴角的笑意越发明显，"不用太深奥'
        ),
        (
            r'"这也行？"许归田目瞪口呆。',
            '"这也行？"许归田目瞪口呆，推了推鼻梁上的眼镜。他的眼神里写满了不可思议，但紧接着就被一种恍然大悟的兴奋所取代。'
        ),
        (
            r'"这叫\'软实力\'。"萧千卷眼神深邃，"秦国可以征服他们的肉体',
            '"这叫\'软实力\'。"萧千卷眼神深邃，声音里透着一种难以言喻的自信。他走到窗边，透过虚拟的窗户眺望着远方那片被黑色笼罩的秦国疆域，"秦国可以征服他们的肉体'
        ),
        (
            r'"秦国可以征服他们的肉体，但我们要腐蚀他们的灵魂。"\n\n……\n\n三年后（游戏时间）。',
            '"秦国可以征服他们的肉体，但我们要腐蚀他们的灵魂。"\n\n他的话语虽然平静，但其中蕴含的决心却让在场的所有人都感到一阵战栗。墨染看着萧千卷的侧脸，那坚毅的轮廓在光影交错中显得格外深沉。她忽然觉得，眼前这个人，似乎已经将整个棋局都握在了手中。\n\n……\n\n三年后（游戏时间）。\n\n时光如白驹过隙，沙盘上的云层又经历了无数次的聚散。春花秋月，夏雨冬雪，一切都在加速流转中变得模糊。'
        ),
    ]
    
    for old, new in replacements:
        content = re.sub(old, new, content, flags=re.MULTILINE)
    
    return content


print("Refinement functions defined")
